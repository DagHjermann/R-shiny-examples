---
title: "ggregular_test"
author: "DHJ"
date: "23 4 2022"
output: html_document
---

## Packages  
```{r}

library(ggplot2)

```


## Main function: Create line   
```{r}

# angle = angle in degrees
# length = length in percentage of xrange
# xrange = total range (max-min) of x values
# aspect = scale of y / scale of x

create_line <- function(x, y, label, angle, length, aspect = 1, xrange = 10){
  
  angle_rad <- angle/180*pi
  length_abs <- length/100*xrange
  x_abs <- length_abs*cos(angle_rad)
  y_abs <- length_abs*cos(angle_rad)*aspect
  data.frame(
    x = x,
    y = y,
    label = label,
    xend = x + x_abs,
    yend = y + y_abs
  )
  
}

# Test
create_line(5, 5, "my_text", 45, 10)
  

```

### Test for plot  
```{r}

create_line(c(4,5,6), c(5,4,6), paste0("mytext", 1:3), 45, 10) %>%
  ggplot() +
  aes(x = x, y = y, xend = xend, yend = yend) +
  geom_point() +
  geom_segment() +
  geom_text(aes(x = xend, y = yend, label = label), hjust = 0)

```

